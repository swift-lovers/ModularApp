#!/bin/bash

# Pre-commit hook: run SwiftLint on staged Swift files (if swiftlint is installed)
if ! command -v swiftlint &> /dev/null; then
  echo "‚ö†Ô∏è  SwiftLint not installed. Skipping lint check."
  exit 0
fi

# Get staged Swift files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep "\.swift$")

if [ -z "$STAGED_FILES" ]; then
  exit 0
fi

echo "üîç Running SwiftLint on staged files..."

PASS=true
for FILE in $STAGED_FILES; do
  swiftlint lint --quiet "$FILE"
  if [ $? -ne 0 ]; then
    PASS=false
  fi
done

if ! $PASS; then
  echo "‚ùå SwiftLint found issues. Please fix them before committing."
  exit 1
fi

echo "‚úÖ SwiftLint passed."
exit 0
